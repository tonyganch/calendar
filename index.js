!function t(e,n,r){function a(s,o){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var v=n[s]={exports:{}};e[s][0].call(v.exports,function(t){var n=e[s][1][t];return a(n?n:t)},v,v.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(t,e,n){function r(t){this.model=new a,this.host=t,this.days=t.querySelectorAll(".cal-day")}var a=t("./calendar_model");r.prototype={host:null,days:null,update:function(t){this.model.update(t);var e=this.model.getCurrentWeekDay();this.highlightDay(e);var n=this.model.getDayHeadersForCurrentWeek();this.fillDayHeaders(n);var r=this.model.getEventsForCurrentWeek();this.clearEvents(),this.displayEvents(r)},highlightDay:function(t){var e=this.host.querySelector(".is-current");e&&e.removeAttribute("is-current");var n=this.days[t];n.setAttribute("is-current",!0)},fillDayHeaders:function(t){for(var e=0,n=t.length;n>e;e++){var r=t[e],a=this.days[e].querySelector(".cal-day-title");a.textContent=r,a.innerText=r}},clearEvents:function(){var t=this.host.querySelectorAll(".cal-event");if(t)for(var e=t.length;e--;){var n=t[e];n.parentNode.removeChild(n)}},displayEvents:function(t){for(var e=0,n=t.length;n>e;e++)this.displayEvent(t[e])},displayEvent:function(t){var e=this.createEventElement(),n=t.title;this.setEventTitle(e,n);var r=t.startInHours;this.setEventTopPosition(e,r);var a=t.duration;this.setEventHeight(e,a),this.setEventWidth(e,t);var i=t.weekDay,s=this.days[i];s.appendChild(e)},createEventElement:function(){var t=document.createElement("div");return t.className="cal-event",t},setEventTitle:function(t,e){t.textContent=e,t.innerText=e,t.title=e},setEventTopPosition:function(t,e){var n=24,r=100*e/n;t.style.top=r+"%"},setEventHeight:function(t,e){var n=24,r=100*e/n;t.style.height=r+"%"},setEventWidth:function(t,e){var n=e.weekDay,r=e.bin,a=e.width,i=this.model.getNumberOfBinsByWeekDay(n),s=100/i,o=r*s,u=100-o-a*s;t.style.left=o+"%",t.style.right=u+"%"}},e.exports=r},{"./calendar_model":2}],2:[function(t,e,n){function r(){}var a=t("./utils");r.prototype={DAYS_IN_WEEK:7,EVENTS_TIME_STEP_IN_MINUTES:30,ONE_DAY_IN_MS:864e5,ONE_WEEK_IN_MS:6048e5,currentDay:null,currentWeekDay:null,weekEnd:null,weekStart:null,_days:[],_events:[],_lastUpdatedDay:null,getCurrentWeekDay:function(){return this._getWeekDayByDate(this.currentDay)},getDayHeadersForCurrentWeek:function(){var t=this._days;return a.map(t,function(t){return t.header})},getEventsForCurrentWeek:function(){return this._events},getNumberOfBinsByWeekDay:function(t){var e=this._days[t].bins;return e?e.length:0},update:function(t){this.currentDay=this._getCurrentDayFromXml(t),this.currentWeekDay=this.getCurrentWeekDay(),this.weekStart=this._getWeekStart(),this.weekEnd=this._getWeekEnd(),this._lastUpdatedDay=null,this._days=this._getDaysData(),this._events=this._getEventsForCurrentWeekFromXml(t)},_createNewBinWithEvent:function(t,e){var n=this._days[t],r=n.bins,a=r.length,i=[n.start.valueOf(),e.start.valueOf()-1],s=[e.end.valueOf()+1,n.end.valueOf()];r.push({id:a,end:e.end,events:[e.id],gaps:[i,s]}),e.bin=a},_eventIsPlannedForCurrentWeek:function(t){return t.end<=this.weekStart?!1:t.start>this.weekEnd?!1:!0},_fillAvailableGaps:function(t){for(var e=0,n=t.length;n>e;e++)for(var r=t[e],a=r.bin,i=this._days[r.weekDay],s=i.bins.length;s>a;a++){var o=i.bins[a+1];if(!o)break;var u=o.gaps,l=this._maybeWidenEvent(r,u);if(!l)break}},_formatDateForDayHeader:function(t){if("undefined"!=typeof Intl){var e={weekday:"short",day:"numeric",month:"short"};return t.toLocaleString([],e)}return t.toDateString()},_getCurrentDayFromXml:function(t){var e=t.getElementsByTagName("dayinweek")[0],n=a.getTextFromElement(e),r=parseInt(n,10);return a.convertUnixTimestampToDate(r)},_getDaysData:function(){for(var t=[],e=this.weekStart,n=0;n<this.DAYS_IN_WEEK;n++){var r=new Date(e),a=e.getDate()+n;r.setDate(a);var i=this._formatDateForDayHeader(r);t.push({start:r,end:r-1+this.ONE_DAY_IN_MS,header:i,events:[],bins:[]})}return t},_getEventDataFromElement:function(t,e){var n=t[e],r=n.getElementsByTagName("title")[0],i=a.getTextFromElement(r),s=n.getElementsByTagName("start")[0],o=a.getDateFromElement(s);this._roundEventStartTime(o);var u=o.getHours(),l=o.getMinutes(),v=u+l/60,d=n.getElementsByTagName("end")[0],h=a.getDateFromElement(d);this._roundEventEndTime(h);var f=this._getEventDurationInHours(o,h);return{id:e,title:i,start:o,startInHours:v,end:h,duration:f,weekDay:this._getWeekDayByDate(o),width:1}},_getEventDurationInHours:function(t,e){var n=e-t+1;return n/1e3/60/60},_getEventsDataFromXml:function(t){for(var e=[],n=t.getElementsByTagName("item"),r=0,a=n.length;a>r;r++){var i=this._getEventDataFromElement(n,r);this._eventIsPlannedForCurrentWeek(i)&&e.push(i)}return e},_getEventsForCurrentWeekFromXml:function(t){var e=this._getEventsDataFromXml(t);return this._splitEventsByDays(e),this._sortEvents(e),this._groupEventsByDays(e),this._groupEventsByBins(e),this._fillAvailableGaps(e),e},_getWeekDayByDate:function(t){var e=t.getDay();return 0===e&&(e=7),e-1},_getWeekEnd:function(){var t=this.weekStart||this._getWeekStart();return new Date(t-1+this.ONE_WEEK_IN_MS)},_getWeekStart:function(){var t=this.currentDay,e=this.currentWeekDay||this.getCurrentWeekDay(),n=t.getDate()-e;return new Date(t.getFullYear(),t.getMonth(),n)},_groupEventsByDays:function(t){for(var e=0,n=t.length;n>e;e++){var r=t[e],a=this._getWeekDayByDate(r.start),i=this._days[a];i.events.push(e)}},_maybeWidenEvent:function(t,e){for(var n=0,r=e.length;r>n;n++){var a=e[n];if(!(t.start.valueOf()>a[1])){if(t.start.valueOf()<a[0]||t.end.valueOf()>a[1])break;return t.end.valueOf()===a[1]?(e.splice(n,1),n--,r--):a[0]=t.end.valueOf()+1,t.width++,!0}e.splice(n,1),n--,r--}return!1},_putEventIntoBin:function(t,e){e.events.push(t.id),e.end=t.end,t.bin=e.id;var n=e.gaps,r=n[n.length-1];if(r[0]===t.start.valueOf())r[0]=t.end.valueOf()+1;else if(r[1]===t.end.valueOf())r[1]=t.start-1;else{var a=[r[0],t.start.valueOf()-1];n.splice(n.length-1,0,a),r[0]=t.end.valueOf()+1}},_putEventIntoRightBin:function(t,e){var n=this._days[e].bins;if(n.length)for(var r=0,a=n.length;a>r;r++){if(t.start>n[r].end){this._putEventIntoBin(t,n[r]);break}r===n.length-1&&this._createNewBinWithEvent(e,t)}else this._createNewBinWithEvent(e,t)},_groupEventsByBins:function(t){for(var e=0,n=this.DAYS_IN_WEEK;n>e;e++)this._putEventsIntoRightBins(t,e)},_putEventsIntoRightBins:function(t,e){for(var n=this._days[e],r=n.events,a=0,i=r.length;i>a;a++){var s=t[r[a]];this._putEventIntoRightBin(s,e)}},_roundEventEndTime:function(t){var e=t.getMinutes(),n=e%this.EVENTS_TIME_STEP_IN_MINUTES;if(n){var r=e+30-n;t.setMinutes(r)}t.setSeconds(0,-1)},_roundEventStartTime:function(t){var e=t.getMinutes(),n=e%this.EVENTS_TIME_STEP_IN_MINUTES;if(n){var r=e-n;t.setMinutes(r)}t.setSeconds(0,0)},_sliceOneDayFromEventEnd:function(t,e){var n=t[e],r=n.end,a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=a.getHours(),s=a.getMinutes(),o=i+s/60,u=this._getEventDurationInHours(a,r),l={title:n.title,start:a,startInHours:o,end:r,duration:u,weekDay:this._getWeekDayByDate(a),width:1,id:t.length};return n.end=new Date(a-1),n.duration=this._getEventDurationInHours(n.start,n.end),l},_sortEvents:function(t){t.sort(function(t,e){return t.start<e.start?-1:t.start>e.start?1:t.duration<e.duration?-1:(t.duration>e.duration,1)})},_splitEventByDays:function(t,e){var n=t[e];if(!this._startsAndEndsTheSameDay(n)){var r=this._sliceOneDayFromEventEnd(t,e);this._eventIsPlannedForCurrentWeek(n)?(this._eventIsPlannedForCurrentWeek(r)&&t.push(r),this._splitEventByDays(t,e)):this._eventIsPlannedForCurrentWeek(r)&&(t[e]=r)}},_splitEventsByDays:function(t){for(var e=t.length;e--;)this._splitEventByDays(t,e)},_startsAndEndsTheSameDay:function(t){var e=t.start,n=e.getDate(),r=t.end,a=r.getDate();return n===a&&r-e<this.ONE_DAY_IN_MS}},e.exports=r},{"./utils":4}],3:[function(t,e,n){function r(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent(e,n)}function a(){var t=document.getElementById("form");r(t,"submit",i)}function i(t){t.preventDefault();var e=document.getElementById("form-input"),n=e.value;s(n,o)}function s(t,e){var n=new XMLHttpRequest;if(n){var r="GET";n.open(r,t,!0),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&304!==n.status?l(t):(v(t),e(n.responseXML)))};try{n.send(null)}catch(a){console.error(a),l(t)}}}function o(t){var e=(new Date).getTime();f.update.call(f,t);var n=(new Date).getTime();u(e,n)}function u(t,e){var n=document.getElementById("load-stats");n.style.display="block";var r=document.getElementById("update-time"),a=e-t;r.textContent=a,r.innerText=a}function l(t){var e=document.getElementById("load-stats");e.style.display="none";var n=document.getElementById("load-message"),r='Failed to load file "'+t+'".';n.className="error",n.textContent=r,n.innerText=r}function v(t){var e=document.getElementById("load-message"),n='File "'+t+'" sucessfully loaded.';e.className="success",e.textContent=n,e.innerText=n}var d=t("./calendar.js"),h=document.getElementById("cal"),f=new d(h);a(),s("data/events.xml",o)},{"./calendar.js":1}],4:[function(t,e,n){var r={convertUnixTimestampToDate:function(t){return new Date(1e3*t)},filter:function(t,e){if(Array.prototype.filter)return t.filter(e);for(var n=Object(t),r=n.length>>>0,a=[],i=0;r>i;i++)if(i in n){var s=n[i];e(s,i,n)&&a.push(s)}return a},getDateFromElement:function(t){var e=this.getTextFromElement(t),n=parseInt(e,10);return this.convertUnixTimestampToDate(n)},getTextFromElement:function(t){return t.textContent?t.textContent:t.childNodes[0].nodeValue},map:function(t,e){if(Array.prototype.map)return t.map(e);for(var n=Object(t),r=n.length>>>0,a=new Array(r),i=0;r>i;){if(i in n){var s=n[i],o=e(s,i,n);a[i]=o}i++}return a}};e.exports=r},{}]},{},[3]);